---
- name: install riak
  apt: name={{ riak_package }} state=present
  when: riak_custom_package == False

- name: install riak custom
  command: dpkg --skip-same-version -i {{ riak_package }}
  register: dpkg_result
  changed_when: dpkg_result.stdout.startswith('Selecting')
  when: riak_custom_package != False

- name: set the riak ulimit
  copy: src=etc_default_riak_ulimit dest=/etc/default/riak owner=riak group=riak

- name: configure init script
  template: src=etc_init_riak.j2 dest=/etc/init.d/riak

- name: configure env script
  template: src=usr_lib_riak_lib_env.sh.j2 dest=/usr/lib/riak/lib/env.sh
